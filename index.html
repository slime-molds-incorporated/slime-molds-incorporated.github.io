<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>Photo Metadata Editor</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <script src="https://cdn.jsdelivr.net/npm/file-saver@2.0.5/dist/FileSaver.min.js"></script>


  <!-- External Styles -->
  <style>
    body {
      margin: 0;
      font-family: sans-serif;
      display: flex;
      height: 100vh;
    }
    #left, #right {
      overflow-y: auto;
      padding: 10px;
    }
    #left {
        width: 60%;
    }
    #right {
        width: 40%;
    }
    h3 {
      margin-top: 0;
    }
    .photo-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
      margin-top: 10px;
    }
    .photo-tile {
      position: relative;
      width: 100px;
      height: 100px;
      border: 1px solid #ccc;
      cursor: pointer;
    }
    .photo-tile.selected {
      border: 2px solid blue;
    }
    .year-grid {
      display: flex;
      flex-wrap: wrap;
      gap: 5px;
    }
    .year-tile {
      width: 60px;
      height: 60px;
      display: flex;
      align-items: center;
      justify-content: center;
      border: 1px solid gray;
      cursor: pointer;
      user-select: none;
    }
    .checkmark {
      position: absolute;
      top: 0;
      left: 0;
      background: white;
      padding: 2px 5px;
      font-size: 10px;
    }
    #export-btn {
      margin-top: 20px;
      padding: 10px 20px;
      font-size: 14px;
    }
  </style>
</head>
<body>
  <div id="left">
    <div style="display: flex; justify-content: space-between; align-items: center;">
        <h3 style="margin: 0;">1. Select Photos</h3>
        <label style="display: flex; align-items: center; gap: 5px; font-weight: normal;">
            Photo Display Size
            <input type="range" id="size-slider" min="50" max="400" value="100" />
        </label>
    </div>
    <input type="file" id="file-input" multiple webkitdirectory />
    <div id="photo-grid" class="photo-grid"></div>
  </div>

  <div id="right">
    <div style="display: flex; align-items: center; gap: 10px;">
      <h3 style="margin: 0;">2. Assign Year</h3>
      <button id="toggle-instructions-btn" style="font-size: 0.8em; padding: 2px 6px; cursor: pointer;">See Instructions</button>
    </div>
    <p id="instructions" style="display: none; margin-top: 8px; font-size: 0.9em; line-height: 1.3; color: #333;">
      Once you've selected photos by left click in the left pane, left click a year to assign them to it.  Those photos will then
      disappear from the left pane, which by default displays only photos with no assigned year.  Right click a year to see the photos
      assigned to it and enter "unassign" mode.  In this mode, left clicking photos will unassign them from the year.  Right click 
      year tile again to go back to assign mode.  The photos you selected in unassign mode will once again be displayed in the unassigned
      photos pool and can be assigned to a new year.
    </p>
    <div id="year-grid" class="year-grid"></div>
    <div id="tagging-container" style="margin-top: 10px;">
      <label for="tag-select">Tags:</label>
      <div id="tag-select" style="border: 1px solid gray; padding: 5px; max-height: 150px; overflow-y: auto;"></div>
      <input type="text" id="new-tag-input" placeholder="Add new tag" style="width: 100%; margin-top: 5px;" />
      <button id="add-tag-btn" style="width: 100%; margin-top: 5px;">Add Tag</button>
    </div>
    <button id="export-btn">Export Metadata</button>
    <div style="position: fixed; bottom: 10px; left: 10px; right: 10px; background: #eee; padding: 10px; border-top: 1px solid #ccc; display: flex; align-items: center; gap: 10px;">
      <button id="load-metadata-btn">Load Existing Metadata - Warning!  Replaces the work you've done in the browser with that in the file you upload.</button>
      <input type="file" id="load-metadata-input" accept=".csv" style="display:none" />
      <span id="load-status" style="font-size: 14px; color: green;"></span>
    </div>
    
  </div>

  <!-- Main JS app -->
  <script type="module" src="app.js"></script>
</body>
</html>
